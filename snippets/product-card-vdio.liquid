{%- assign hover_video = product.media | where: 'media_type', 'video' | first -%}
{%- comment -%}
如果你是用外链视频（YouTube/Vimeo），media_type 是 external_video。
不过要实现“悬浮即播”更推荐上传 MP4 到产品媒体，这样是 <video> 标签，最稳定。
{%- endcomment -%}

<div class="product-card__media-wrapper {% if hover_video %}has-hover-video{% endif %}">
    <a href="{{ product.url }}" class="product-card__link">
      {%- comment -%} 封面图 {%- endcomment -%}
      {{ product.featured_media
        | image_url: width: 800
        | image_tag:
          loading: 'lazy',
          class: 'product-card__img'
      }}
  
      {%- if hover_video -%}
        <div class="product-card__video-wrap" hidden>
          {{ hover_video | video_tag:
              autoplay: false,
              loop: true,
              muted: true,
              controls: false,
              playsinline: true,
              preload: 'none',
              class: 'product-card__video',
              id: 'vid-' | append: product.id
          }}
        </div>
      {%- endif -%}
    </a>
    
    {%- comment -%} 产品名称和按钮 - 左上角 {%- endcomment -%}
    <div class="product-card__title-overlay">
      <h3 class="product-card__title">{{ product.title }}</h3>
      <a href="{{ product.url }}" class="product-card__learn-more-btn">Learn More</a>
    </div>
    
    {%- comment -%} 产品价格 - 右下角 {%- endcomment -%}
    <div class="product-card__price-overlay">
      <div class="product-card__price">
        {%- if product.compare_at_price > product.price -%}
          <span class="product-card__price-sale">{{ product.price | money }}</span>
          <span class="product-card__price-compare">{{ product.compare_at_price | money }}</span>
        {%- else -%}
          <span class="product-card__price-regular">{{ product.price | money }}</span>
        {%- endif -%}
      </div>
    </div>
  </div>